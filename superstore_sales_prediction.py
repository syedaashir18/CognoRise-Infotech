# -*- coding: utf-8 -*-
"""Superstore_sales_prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1LJRbZdlLvWhEzyQNdmbZVVmHx2o_nu_J
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_csv("superstore.csv")

df.head(10)

df.drop(['Row ID', 'Country', 'Customer ID', 'Product ID'], axis =1 , inplace = True)

df.head(10)

df.dtypes

df['Order Date'] = pd.to_datetime(df['Order Date'], format= '%d/%m/%Y')
df['Ship Date'] = pd.to_datetime(df['Ship Date'], format = '%d/%m/%Y')
df.dtypes

df['Customer Name'].nunique()

print("Unique Ship Modes -", df['Ship Mode'].unique())
print("Unique Sengments -", df['Segment'].unique())
print("Unique Number of Cities -", df["City"].nunique())
print("Unique Number of States -", df["State"].nunique())

print("Number of unique Postal Codes -", df["Postal Code"].nunique())

print("Unique Resgions -",df['Region'].unique())

print("Number of Unique Product Names -", df['Product Name'].nunique())

print("Number of Unique -", df["Category"].unique())

print("Number of Unique -", df["Sub-Category"].unique())

Per_state_sales = df.groupby("State")['Sales'].sum().reset_index()
plt.figure(figsize=(14,10))
sns.barplot(x = 'Sales', y = 'State', data = Per_state_sales, orient='h', palette='viridis')

sales_per_region = df.groupby('Region')['Sales'].sum().reset_index()
plt.figure(figsize= (12,8))
sns.barplot(x = 'Region', y = 'Sales', data= sales_per_region, palette='viridis')

city_sales = df.groupby('City')['Sales'].sum().reset_index()
city_sales_index = city_sales['Sales'].idxmax()
city_sales.loc[city_sales_index]

category_sales = df.groupby('Category')['Sales'].sum().reset_index()

plt.pie(x=category_sales['Sales'], labels=category_sales['Category'], autopct='%1.2f%%')
plt.show()

import plotly.express as px

salesCatDetails = df.groupby(['Category', 'Sub-Category'])['Sales'].sum().reset_index()
fig = px.sunburst(
    salesCatDetails, path=['Category', 'Sub-Category'], values='Sales')
fig.update_layout( width=800,height=800)
fig.show()

